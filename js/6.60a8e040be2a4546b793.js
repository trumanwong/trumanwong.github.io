(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"1GJp":function(t,e,a){"use strict";function i(t){if("string"==typeof t.data)this.$message.error(t.status+" "+t.statusText);else{var e=t.data.errors,a="";Object.keys(e).map((function(t,i){var l=e[t];a+='<span style="color: #e74c3c">'+l[0]+"</span><br>"})),console.log({title:"Error Text!",type:"error",html:a})}}a.d(e,"a",(function(){return i}))},QZBr:function(t,e,a){"use strict";var i={data:function(){return{list:[],total:0,page:1,pageSize:5}},created:function(){this.getTableData()},props:{showFiles:{type:Boolean,default:function(){return!1}},currentRow:{type:Object,default:function(){return{}}}},methods:{getTableData:function(){var t=this;this.$http.get("file",{params:{page:this.page,per_page:this.pageSize}}).then((function(e){t.list=e.data.data,t.pageSize=e.data.per_page,t.total=e.data.total}))},handlePageChange:function(t){this.page=t,this.getTableData()},handleCurrentChange:function(t){this.$emit("setCurrentRow",t)},confirm:function(){this.$emit("setShowFiles",!1),this.$emit("showCurrentRow")}}},l=a("KHd+"),s=Object(l.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"文件列表",visible:t.showFiles},on:{"update:visible":function(e){t.showFiles=e}}},[a("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:t.list,"highlight-current-row":"",height:"250"},on:{"current-change":t.handleCurrentChange}},[a("el-table-column",{attrs:{fixed:"",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("table.name"),width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[-1!==e.row.mime_type.indexOf("image/")?a("el-image",{attrs:{title:e.row.name,src:e.row.path}}):a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{property:"category.name",label:t.$t("table.category"),width:"120"}}),t._v(" "),a("el-table-column",{attrs:{property:"mime_type",label:t.$t("table.type")}}),t._v(" "),a("el-table-column",{attrs:{property:"created_at",label:t.$t("table.date")}}),t._v(" "),a("el-table-column",{attrs:{property:"size",label:t.$t("table.size")}})],1),t._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize},on:{"current-change":t.handlePageChange}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.showFiles=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)}),[],!1,null,null,null);e.a=s.exports},UEMJ:function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,".cover-upload[data-v-c49bdafa]{display:inline-block}.cover-upload .file[data-v-c49bdafa]{position:relative;margin:0 auto;display:block;width:100px;height:35px;line-height:35px;font-size:12px}.cover-upload .file span[data-v-c49bdafa]{display:block;position:absolute;top:0;left:0;right:0}.cover-upload .file input[data-v-c49bdafa]{position:absolute;left:0;right:0;top:0;width:100px;height:35px;opacity:0}",""])},Vjnh:function(t,e,a){var i=a("UEMJ");"string"==typeof i&&(i=[[t.i,i,""]]);var l={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(i,l);i.locals&&(t.exports=i.locals)},aXGX:function(t,e,a){"use strict";var i={data:function(){return{selected:null,options:[],tags:null,allTag:[],startTime:"",option:{type:"min",week:["Mo","Tu","We","Th","Fr","Sa","Su"],month:["January","February","March","April","May","June","July","August","September","October","November","December"],format:"YYYY-MM-DD HH:mm:ss",placeholder:"Published At?",inputStyle:{display:"inline-block",padding:"6px 6px 6px 10px",height:"41px","line-height":"22px","font-size":"13px",border:"1px solid #dce4ec","border-radius":"6px",color:"#5F5F5F"},color:{header:"#52697f",headerText:"#1abc9c"},buttons:{ok:"Ok",cancel:"Cancel"},overlayOpacity:.5,dismissible:!0}}},mounted:function(){this.option.placeholder=this.$t("form.published_at")},created:function(){this.loadCategories(),this.loadTags()},methods:{loadCategories:function(){var t=this;this.$http.get("categories").then((function(e){t.options=e.data.data}))},loadTags:function(){var t=this;this.$http.get("tags").then((function(e){t.allTag=e.data.data}))}}},l=a("KHd+"),s=Object(l.a)(i,void 0,void 0,!1,null,null,null).exports,o=a("Kbl0"),r=a.n(o),n=a("1GJp"),c=a("QMhP"),u=a.n(c),p=a("/PCo"),d=a.n(p),m={mixins:[s],components:{FileTable:a("QZBr").a},props:{article:{type:Object,default:function(){return{page_image:""}}}},data:function(){return{simplemde:"",content:"",option:{},tableData:[],showFiles:!1,currentRow:null}},computed:{mode:function(){return this.article.id?"update":"create"}},watch:{article:function(){if(this.article.category&&this.article.tags){this.selected=this.article.category.data.id,this.tags=[];for(var t=0;t<this.article.tags.data.length;t++)this.tags.push(this.article.tags.data[t].id);this.simplemde.value(this.article.content),this.startTime=this.article.published_time}}},mounted:function(){var t=this.$t||this.$i18n.t,e=this;this.simplemde=new r.a({element:document.getElementById("editor"),placeholder:t("form.content_placeholder",{type:t("form.article")}),autoDownloadFontAwesome:!0,forceSync:!0,previewRender:function(t,a){return a.className+=" markdown",e.parse(t)}}),this.contentUploader()},methods:{parse:function(t){return marked.setOptions({highlight:function(t){return hljs.highlightAuto(t).value},sanitize:!0}),d.a.toImage(marked(t))},onSubmit:function(){var t=this;if(this.tags&&this.selected){var e="article"+(this.article.id?"/"+this.article.id:""),a=this.article.id?"patch":"post";this.article.published_at=this.startTime,this.article.content=this.simplemde.value(),this.article.category_id=this.selected,this.article.tags=JSON.stringify(this.tags),this.$http[a](e,this.article).then((function(e){t.$message.success("You "+t.mode+"d the article success!"),t.$router.push({name:"dashboard.article"})})).catch((function(t){var e=t.response;Object(n.a)(e)}))}else this.$message.error("Category and Tag must select one or more.")},selectCover:function(){this.showFiles=!0},contentUploader:function(){var t=this;this.simplemde.codemirror.on("paste",(function(t,e){e.clipboardData.types.indexOf("Files")>=0&&e.preventDefault()}));var e=new u.a.FineUploaderBasic({paste:{targetElement:document.querySelector(".CodeMirror")},request:{endpoint:"/api/file/upload",inputName:"image",customHeaders:{"X-CSRF-TOKEN":window.Laravel.csrfToken,"X-Requested-With":"XMLHttpRequest"},params:{strategy:"article"}},validation:{allowedExtensions:["jpeg","jpg","gif","png"]},callbacks:{onPasteReceived:function(e){var a=new u.a.Promise;return null==e||void 0===e.type||e.type.indexOf("image/")?(this.$message.error("Only can upload image!"),a.failure("not a image.")):a.then((function(){t.createdImageUploading("image.png")})).success("image")},onComplete:function(e,a,i){t.replaceImageUploading(a,i.url)}}});new u.a.DragAndDrop({dropZoneElements:[document.querySelector(".CodeMirror")],callbacks:{processingDroppedFilesComplete:function(a,i){a.forEach((function(e){t.createdImageUploading(e.name)})),e.addFiles(a)}}})},getImageUploading:function(){return"\n![Uploading ...]()\n"},createdImageUploading:function(t){this.simplemde.value(this.simplemde.value()+this.getImageUploading())},replaceImageUploading:function(t,e){var a="\n!["+t+"]("+e+")\n";this.simplemde.value(this.simplemde.value().replace(this.getImageUploading(),a))},setShowFiles:function(t){this.showFiles=t},showCurrentRow:function(){this.article.page_image=this.currentRow.path,this.article.previewSrcList=[this.currentRow.path]},setCurrentRow:function(t){this.currentRow=t}}},h=(a("eucD"),Object(l.a)(m,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("form",{staticClass:"col-sm-9 offset-sm-1",on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label"},[t._v(t._s(t.$t("form.category")))]),t._v(" "),a("div",{staticClass:"col-sm-10"},[a("el-select",{attrs:{clearable:"",placeholder:t.$t("form.select_category")},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},t._l(t.options,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"title"}},[t._v(t._s(t.$t("form.title")))]),t._v(" "),a("div",{staticClass:"col-sm-10"},[a("el-input",{attrs:{placeholder:t.$t("form.input_title"),clearable:""},model:{value:t.article.title,callback:function(e){t.$set(t.article,"title",e)},expression:"article.title"}})],1)]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"subtitle"}},[t._v(t._s(t.$t("form.subtitle")))]),t._v(" "),a("div",{staticClass:"col-sm-10"},[a("el-input",{attrs:{placeholder:t.$t("form.input_subtitle"),clearable:""},model:{value:t.article.subtitle,callback:function(e){t.$set(t.article,"subtitle",e)},expression:"article.subtitle"}})],1)]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"page_image"}},[t._v(t._s(t.$t("form.page_image")))]),t._v(" "),a("div",{staticClass:"col-sm-5"},[a("el-input",{attrs:{placeholder:"ex: /uploads/default_avatar.png",disabled:!0},model:{value:t.article.page_image,callback:function(e){t.$set(t.article,"page_image",e)},expression:"article.page_image"}})],1),t._v(" "),a("div",{staticClass:"col-sm-5"},[null!=t.article.page_image&&""!=t.article.page_image?a("el-image",{staticStyle:{width:"35px",height:"35px"},attrs:{src:t.article.page_image,"preview-src-list":t.article.previewSrcList}}):t._e(),t._v(" "),a("div",{staticClass:"cover-upload pull-right"},[a("el-button",{attrs:{type:"primary"},on:{click:t.selectCover}},[t._v(t._s(t.$t("form.upload_file"))),a("i",{staticClass:"el-icon-upload el-icon--right"})])],1)],1)]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"title"}},[t._v(t._s(t.$t("form.content")))]),t._v(" "),a("div",{staticClass:"col-sm-10"},[a("el-input",{attrs:{type:"textarea",id:"editor"}})],1)]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label"},[t._v(t._s(t.$t("form.tag")))]),t._v(" "),a("div",{staticClass:"col-sm-10"},[a("el-select",{attrs:{filterable:"",multiple:"",placeholder:t.$t("form.select_tag")},model:{value:t.tags,callback:function(e){t.tags=e},expression:"tags"}},t._l(t.allTag,(function(t){return a("el-option",{key:t.id,attrs:{label:t.tag,value:t.id}})})),1)],1)]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label",attrs:{for:"meta_description"}},[t._v(t._s(t.$t("form.meta_description")))]),t._v(" "),a("div",{staticClass:"col-sm-10"},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",maxlength:"255","show-word-limit":"",clearable:""},model:{value:t.article.meta_description,callback:function(e){t.$set(t.article,"meta_description",e)},expression:"article.meta_description"}})],1)]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2 col-form-label"},[t._v(t._s(t.$t("form.datetime")))]),t._v(" "),a("div",{staticClass:"col-sm-10"},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime"},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}})],1)]),t._v(" "),a("div",{staticClass:"form-group row"},[a("div",{staticClass:"col-sm-2 col-form-label"},[t._v("\n          "+t._s(t.$t("form.is_draft"))+"\n        ")]),t._v(" "),a("div",{staticClass:"col-sm-2"},[a("div",{staticClass:"togglebutton",staticStyle:{"margin-top":"6px"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.article.is_draft,callback:function(e){t.$set(t.article,"is_draft",e)},expression:"article.is_draft"}})],1)]),t._v(" "),a("div",{staticClass:"col-sm-2 col-form-label"},[t._v("\n          "+t._s(t.$t("form.is_original"))+"\n        ")]),t._v(" "),a("div",{staticClass:"col-sm-2"},[a("div",{staticClass:"togglebutton",staticStyle:{"margin-top":"6px"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.article.is_original,callback:function(e){t.$set(t.article,"is_original",e)},expression:"article.is_original"}})],1)]),t._v(" "),a("div",{staticClass:"col-sm-2 col-form-label"},[t._v("\n          "+t._s(t.$t("form.is_admin"))+"\n        ")]),t._v(" "),a("div",{staticClass:"col-sm-2"},[a("div",{staticClass:"togglebutton",staticStyle:{"margin-top":"6px"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.article.type,callback:function(e){t.$set(t.article,"type",e)},expression:"article.type"}})],1)])])]),t._v(" "),a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"form-group row"},[a("div",{staticClass:"offset-sm-2 col-sm-10"},[a("button",{staticClass:"btn btn-info",attrs:{type:"submit"}},[t._v(t._s(t.article.id?t.$t("form.edit"):t.$t("form.create")))])])])])]),t._v(" "),a("file-table",{attrs:{currentRow:t.currentRow,showFiles:t.showFiles},on:{setShowFiles:t.setShowFiles,showCurrentRow:t.showCurrentRow,setCurrentRow:t.setCurrentRow}})],1)}),[],!1,null,"c49bdafa",null));e.a=h.exports},eucD:function(t,e,a){"use strict";a("Vjnh")},fi6a:function(t,e,a){"use strict";a.r(e);var i={components:{ArticleForm:a("aXGX").a}},l=a("KHd+"),s=Object(l.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("vue-form",{attrs:{title:this.$t("form.create_article")}},[e("template",{slot:"buttons"},[e("el-link",{staticStyle:{"text-decoration":"none"},attrs:{icon:"el-icon-back",underline:!1,href:"/dashboard/articles"}},[this._v(this._s(this.$t("form.back")))])],1),this._v(" "),e("template",{slot:"content"},[e("article-form")],1)],2)}),[],!1,null,null,null);e.default=s.exports}}]);